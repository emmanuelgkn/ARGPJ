from qagent import Qagent
from env import MPR_env
from MPRengine import Board
import time 
import matplotlib.pyplot as plt
import numpy as np
import torch
import torch.nn as nn
from reseau import QNetwork

qtable = [
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [0., 0., 0.],
    [-19.15090123, -18.99420331,  -8.93503463],
    [-16.80565287, -17.29845597,  -4.6963367 ],
    [-14.81951486,   7.64481768, -14.43480666],
    [-16.52266542,  -3.32050357, -16.13716716],
    [-17.01272234, -16.64900867,  25.94891029],
    [-15.67496433,  11.5997314 , -15.76516239],
    [-19.13976649, -16.89840988,  -6.17056906],
    [-21.67107972, -21.49656021,  -6.38866181],
    [-18.70687312, -18.27511804,   3.02305219],
    [-19.16305681, -18.82954242,  -5.74754373],
    [-21.60215332, -20.79983271, -10.70759954],
    [-17.9295803 , -17.83802801,  -3.31814651],
    [-19.1099531 ,  -7.49639007, -17.0160393 ],
    [-16.63412988, -17.02109569,  13.75892552],
    [-14.58681469, -13.80579593,  -2.89235219],
    [-11.54761824, -11.79871   ,   2.65974332],
    [-16.74727117, -16.3205826 ,  -3.85946689],
    [-14.23787506,  13.95859094, -13.81642185],
    [-17.98306355, -17.71523367,  -9.10457418],
    [-21.24432452, -21.07511762, -11.32270643],
    [-16.65926732, -16.65329387,   6.2047527 ],
    [-21.8194668 , -21.9568622 ,  -6.66555933],
    [-20.53203055, -20.69711643,  -7.68878024],
    [-18.01394229, -17.49290941,  -4.18991651],
    [-11.70117236, -12.18148358,   2.17781463],
    [-15.45700006, -14.67330142,  -3.4932413 ],
    [-13.67610067, -14.73889973,  78.80403348],
    [-11.01586656, -10.98116744,   5.74873633],
    [-14.59463499, -15.08640938,  18.5943674 ],
    [-13.85771036,   8.98521588, -13.84682734],
    [-18.14120412, -18.05732512,  -9.98922633],
    [-21.63994129, -21.33680424,   4.29288908],
    [-17.50385694, -17.28849893,   0.81144146],
    [-17.83996698, -17.85189705,  -2.01659906],
    [-22.8675873 , -20.53563083, -10.78280508],
    [-17.13364395, -17.3202561 ,   6.88144175],
]

env = MPR_env(custom=False)
agent = Qagent(env,500,1000)
agent.qtable = qtable

# agent.model.load_state_dict(torch.load('weights_qagent.pth', weights_only=True,map_location=torch.device('cpu')))

agent.one_run()